[2024-09-27 11:12:30,143] [INFO] [real_accelerator.py:203:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-09-27 11:12:30,374] [INFO] [real_accelerator.py:203:get_accelerator] Setting ds_accelerator to cuda (auto detect)
WARNING: falling back to non-distributed strategy.
WARNING: falling back to non-distributed strategy.
##############################################
# Starting execution of 'ProfilerTrainer'... #
##############################################
Saved 'best_model.pth' checkpoint at checkpoints/best_model.pth
Saved 'best_model.pth' checkpoint at checkpoints/best_model.pth
Saved 'best_model.pth' checkpoint at checkpoints/best_model.pth
Saved 'best_model.pth' checkpoint at checkpoints/best_model.pth
Saved 'best_model.pth' checkpoint at checkpoints/best_model.pth
Saved 'best_model.pth' checkpoint at checkpoints/best_model.pth
Saved 'best_model.pth' checkpoint at checkpoints/best_model.pth
Saved 'best_model.pth' checkpoint at checkpoints/best_model.pth
Saved 'best_model.pth' checkpoint at checkpoints/best_model.pth
Saved 'best_model.pth' checkpoint at checkpoints/best_model.pth
Saved 'epoch_9.pth' checkpoint at checkpoints/epoch_9.pth
prof.key_averages() -------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg    # of Calls  
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
                         volta_sgemm_64x32_sliced1x4_tn         0.00%       0.000us         0.00%       0.000us       0.000us        2.453s        13.74%        2.453s     223.986us         10950  
                                  volta_sgemm_128x32_nt         0.00%       0.000us         0.00%       0.000us       0.000us        1.953s        10.94%        1.953s     104.025us         18770  
cudnn_infer_volta_scudnn_winograd_128x128_ldg1_ldg4_...         0.00%       0.000us         0.00%       0.000us       0.000us        1.080s         6.05%        1.080s      98.674us         10950  
void at::native::(anonymous namespace)::max_pool_bac...         0.00%       0.000us         0.00%       0.000us       0.000us        1.001s         5.61%        1.001s     106.727us          9380  
void cudnn::winograd_nonfused::winogradWgradDelta4x4...         0.00%       0.000us         0.00%       0.000us       0.000us     692.955ms         3.88%     692.955ms      36.938us         18760  
                                  volta_gcgemm_32x32_nt         0.00%       0.000us         0.00%       0.000us       0.000us     660.362ms         3.70%     660.362ms      70.401us          9380  
void at::native::(anonymous namespace)::multi_tensor...         0.00%       0.000us         0.00%       0.000us       0.000us     586.570ms         3.29%     586.570ms      31.267us         18760  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us     531.038ms         2.97%     531.038ms      18.871us         28140  
void fft2d_r2c_32x32<float, false, 0u, false>(float2...         0.00%       0.000us         0.00%       0.000us       0.000us     528.076ms         2.96%     528.076ms      56.298us          9380  
void at::native::(anonymous namespace)::multi_tensor...         0.00%       0.000us         0.00%       0.000us       0.000us     517.627ms         2.90%     517.627ms      27.592us         18760  
void at::native::(anonymous namespace)::multi_tensor...         0.00%       0.000us         0.00%       0.000us       0.000us     506.943ms         2.84%     506.943ms      27.023us         18760  
void at::native::(anonymous namespace)::multi_tensor...         0.00%       0.000us         0.00%       0.000us       0.000us     498.249ms         2.79%     498.249ms      26.559us         18760  
void at::native::reduce_kernel<512, 1, at::native::R...         0.00%       0.000us         0.00%       0.000us       0.000us     470.714ms         2.64%     470.714ms      25.091us         18760  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us     419.710ms         2.35%     419.710ms      12.777us         32850  
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us     415.065ms         2.32%     415.065ms      18.953us         21900  
void cudnn::winograd_nonfused::winogradWgradData4x4<...         0.00%       0.000us         0.00%       0.000us       0.000us     369.809ms         2.07%     369.809ms      19.713us         18760  
void at::native::(anonymous namespace)::multi_tensor...         0.00%       0.000us         0.00%       0.000us       0.000us     334.364ms         1.87%     334.364ms      35.646us          9380  
void at::native::reduce_kernel<512, 1, at::native::R...         0.00%       0.000us         0.00%       0.000us       0.000us     321.770ms         1.80%     321.770ms       2.671us        120450  
void at::native::(anonymous namespace)::multi_tensor...         0.00%       0.000us         0.00%       0.000us       0.000us     310.895ms         1.74%     310.895ms      33.144us          9380  
void at::native::(anonymous namespace)::multi_tensor...         0.00%       0.000us         0.00%       0.000us       0.000us     308.961ms         1.73%     308.961ms      32.938us          9380  
void at::native::(anonymous namespace)::max_pool_for...         0.00%       0.000us         0.00%       0.000us       0.000us     288.598ms         1.62%     288.598ms      26.356us         10950  
void fft2d_r2c_32x32<float, false, 1u, false>(float2...         0.00%       0.000us         0.00%       0.000us       0.000us     286.109ms         1.60%     286.109ms      30.502us          9380  
void fft2d_c2r_32x32<float, false, false, 0u, false,...         0.00%       0.000us         0.00%       0.000us       0.000us     269.931ms         1.51%     269.931ms      28.777us          9380  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us     264.356ms         1.48%     264.356ms       1.097us        240900  
std::enable_if<!(false), void>::type internal::gemvx...         0.00%       0.000us         0.00%       0.000us       0.000us     234.096ms         1.31%     234.096ms      24.957us          9380  
       cudnn_infer_volta_scudnn_128x32_relu_small_nn_v1         0.00%       0.000us         0.00%       0.000us       0.000us     223.522ms         1.25%     223.522ms      20.432us         10940  
                         Memcpy DtoD (Device -> Device)         0.00%       0.000us         0.00%       0.000us       0.000us     214.561ms         1.20%     214.561ms       1.089us        197110  
                       Memcpy HtoD (Pageable -> Device)         0.00%       0.000us         0.00%       0.000us       0.000us     204.774ms         1.15%     204.774ms       4.675us         43800  
                                  volta_sgemm_128x32_nn         0.00%       0.000us         0.00%       0.000us       0.000us     200.554ms         1.12%     200.554ms      21.381us          9380  
void at::native::reduce_kernel<512, 1, at::native::R...         0.00%       0.000us         0.00%       0.000us       0.000us     155.165ms         0.87%     155.165ms       7.085us         21900  
                         volta_sgemm_32x32_sliced1x4_tn         0.00%       0.000us         0.00%       0.000us       0.000us     136.098ms         0.76%     136.098ms      12.440us         10940  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us     126.077ms         0.71%     126.077ms       4.478us         28156  
void at::native::(anonymous namespace)::fused_dropou...         0.00%       0.000us         0.00%       0.000us       0.000us     113.312ms         0.63%     113.312ms       6.040us         18760  
                         volta_sgemm_32x32_sliced1x4_nt         0.00%       0.000us         0.00%       0.000us       0.000us     104.194ms         0.58%     104.194ms      11.120us          9370  
void at::native::unrolled_elementwise_kernel<at::nat...         0.00%       0.000us         0.00%       0.000us       0.000us      96.073ms         0.54%      96.073ms       1.462us         65700  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us      90.054ms         0.50%      90.054ms       4.800us         18760  
void at::native::reduce_kernel<128, 4, at::native::R...         0.00%       0.000us         0.00%       0.000us       0.000us      85.744ms         0.48%      85.744ms       9.141us          9380  
                       Memcpy DtoH (Device -> Pageable)         0.00%       0.000us         0.00%       0.000us       0.000us      84.852ms         0.48%      84.852ms       2.559us         33154  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us      82.467ms         0.46%      82.467ms       1.255us         65700  
void cudnn::winograd_nonfused::winogradWgradOutput4x...         0.00%       0.000us         0.00%       0.000us       0.000us      76.511ms         0.43%      76.511ms       4.078us         18760  
                                  volta_sgemm_32x128_nn         0.00%       0.000us         0.00%       0.000us       0.000us      75.754ms         0.42%      75.754ms       8.076us          9380  
void at::native::unrolled_elementwise_kernel<at::nat...         0.00%       0.000us         0.00%       0.000us       0.000us      67.428ms         0.38%      67.428ms       1.539us         43800  
void at::native::reduce_kernel<256, 2, at::native::R...         0.00%       0.000us         0.00%       0.000us       0.000us      66.991ms         0.38%      66.991ms       7.142us          9380  
void cudnn::winograd::generateWinogradTilesKernel<0,...         0.00%       0.000us         0.00%       0.000us       0.000us      57.208ms         0.32%      57.208ms       5.224us         10950  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us      45.916ms         0.26%      45.916ms       2.097us         21900  
void at::native::(anonymous namespace)::nll_loss_for...         0.00%       0.000us         0.00%       0.000us       0.000us      43.526ms         0.24%      43.526ms       3.975us         10950  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us      36.608ms         0.21%      36.608ms       1.672us         21900  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us      36.460ms         0.20%      36.460ms       1.665us         21900  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us      36.292ms         0.20%      36.292ms       1.657us         21900  
void at::native::(anonymous namespace)::nll_loss_bac...         0.00%       0.000us         0.00%       0.000us       0.000us      28.291ms         0.16%      28.291ms       3.016us          9380  
void (anonymous namespace)::softmax_warp_forward<flo...         0.00%       0.000us         0.00%       0.000us       0.000us      22.677ms         0.13%      22.677ms       2.071us         10950  
void cask_cudnn_infer::computeOffsetsKernel<false, f...         0.00%       0.000us         0.00%       0.000us       0.000us      21.713ms         0.12%      21.713ms       1.985us         10940  
void (anonymous namespace)::softmax_warp_backward<fl...         0.00%       0.000us         0.00%       0.000us       0.000us      18.844ms         0.11%      18.844ms       2.009us          9380  
                                        Memset (Device)         0.00%       0.000us         0.00%       0.000us       0.000us     313.000us         0.00%     313.000us       0.029us         10932  
void at::native::(anonymous namespace)::CatArrayBatc...         0.00%       0.000us         0.00%       0.000us       0.000us     218.000us         0.00%     218.000us       2.180us           100  
void implicit_convolve_sgemm<float, float, 1024, 5, ...         0.00%       0.000us         0.00%       0.000us       0.000us     147.000us         0.00%     147.000us      14.700us            10  
void at::native::reduce_kernel<512, 1, at::native::R...         0.00%       0.000us         0.00%       0.000us       0.000us     145.000us         0.00%     145.000us       4.833us            30  
void splitKreduce_kernel<32, 16, int, float, float, ...         0.00%       0.000us         0.00%       0.000us       0.000us     119.000us         0.00%     119.000us       5.950us            20  
void gemmSN_TN_kernel<float, 128, 16, 2, 4, 8, 9, fa...         0.00%       0.000us         0.00%       0.000us       0.000us      68.000us         0.00%      68.000us       6.800us            10  
                                        cudaMemcpyAsync        36.98%        7.965s        36.98%        7.965s      29.061us       0.000us         0.00%       0.000us       0.000us        274064  
                                  cudaStreamSynchronize         6.52%        1.404s         6.52%        1.404s      25.510us       0.000us         0.00%       0.000us       0.000us         55054  
                                     cudaGetDeviceCount         0.00%       3.000us         0.00%       3.000us       1.500us       0.000us         0.00%       0.000us       0.000us             2  
                                   cudaDriverGetVersion         0.00%       3.000us         0.00%       3.000us       1.500us       0.000us         0.00%       0.000us       0.000us             2  
                                 cudaDeviceGetAttribute         0.00%     269.000us         0.00%     269.000us       4.270us       0.000us         0.00%       0.000us       0.000us            63  
                             cudaGetDeviceProperties_v2         0.00%     227.000us         0.00%     227.000us     113.500us       0.000us         0.00%       0.000us       0.000us             2  
                              cudaStreamCreateWithFlags         0.03%       6.070ms         0.03%       6.070ms     189.688us       0.000us         0.00%       0.000us       0.000us            32  
                                             cudaMalloc         0.01%       3.003ms         0.01%       3.003ms     150.150us       0.000us         0.00%       0.000us       0.000us            20  
                                        cudaMemsetAsync         0.80%     172.297ms         0.80%     172.297ms       7.878us       0.000us         0.00%       0.000us       0.000us         21872  
                                          cudaHostAlloc         0.01%       1.664ms         0.01%       1.664ms     832.000us       0.000us         0.00%       0.000us       0.000us             2  
                               cudaHostGetDevicePointer         0.00%       4.000us         0.00%       4.000us       2.000us       0.000us         0.00%       0.000us       0.000us             2  
                                               cudaFree         0.16%      34.175ms         0.16%      34.175ms       4.882ms       0.000us         0.00%       0.000us       0.000us             7  
                                   cudaGetSymbolAddress         0.00%     695.000us         0.00%     695.000us     695.000us       0.000us         0.00%       0.000us       0.000us             1  
                                  cudaStreamIsCapturing         0.32%      68.237ms         0.32%      68.237ms       0.992us       0.000us         0.00%       0.000us       0.000us         68806  
                                  cudaStreamGetPriority         0.11%      23.476ms         0.11%      23.476ms       0.469us       0.000us         0.00%       0.000us       0.000us         50040  
                       cudaDeviceGetStreamPriorityRange         0.14%      29.555ms         0.14%      29.555ms       0.591us       0.000us         0.00%       0.000us       0.000us         50040  
                                       cudaLaunchKernel        53.39%       11.499s        53.39%       11.499s       9.486us       0.000us         0.00%       0.000us       0.000us       1212226  
          cudaOccupancyMaxActiveBlocksPerMultiprocessor         0.65%     139.852ms         0.65%     139.852ms       3.436us       0.000us         0.00%       0.000us       0.000us         40701  
                                    cudaStreamWaitEvent         0.84%     180.333ms         0.84%     180.333ms       1.131us       0.000us         0.00%       0.000us       0.000us        159460  
cudaOccupancyMaxActiveBlocksPerMultiprocessorWithFla...         0.04%       8.471ms         0.04%       8.471ms     445.842us       0.000us         0.00%       0.000us       0.000us            19  
                                  cudaDeviceSynchronize         0.00%      92.000us         0.00%      92.000us      92.000us       0.000us         0.00%       0.000us       0.000us             1  
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 21.537s
Self CUDA time total: 17.856s

##########################################
# 'ProfilerTrainer' executed in 323.752s #
##########################################
