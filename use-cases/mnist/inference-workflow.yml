# Load with OmegaConf

# Other configuration files to merge with this file via OmegaConf 
conf-dependencies:
  - meta.yml

steps:
  - preprocessing:
      doc: Download and split MNIST dataset into train and test sets
      command: python ${root}/mnist-preproc.py
      env: 
        file: ${root}/env-files/preproc-env.yml
        prefix: ${root}/.venv-preproc
      args:
        output: ${datasets.preproc-images.location}
        stage: test
  - ml-inference:
      doc: Apply a pre-trained neural network on unseen data and store them
      command: itwinai predict
      env: 
        file: ./ai/env-files/pytorch-env-freeze.yml
        prefix: ./ai/.venv-pytorch
        source: ./ai
      args:
        config: ${root}/mnist-ai-inference.yml
        input-dataset: ${datasets.preproc-images.location}
        predictions-location: ${datasets.ml-predictions.location}
        ml-logs: ${datasets.ml-logs.location}

