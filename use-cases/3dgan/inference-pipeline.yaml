executor:
  class_path: itwinai.components.Executor
  init_args:
    steps:
      - class_path: dataloader.Lightning3DGANDownloader
        init_args:
          data_path: exp_data/
          data_url: https://drive.google.com/drive/folders/1uPpz0tquokepptIfJenTzGpiENfo2xRX

      - class_path: trainer.Lightning3DGANPredictor
        init_args:
          model:
            class_path: trainer.LightningModelLoader
            init_args:
              model_uri: 3dgan-inference.pth
          # Pytorch lightning config for training
          config:
            seed_everything: 4231162351
            trainer:
              accelerator: auto
              accumulate_grad_batches: 1
              barebones: false
              benchmark: null
              # callbacks:
              #   # - class_path: lightning.pytorch.callbacks.early_stopping.EarlyStopping
              #   #   init_args:
              #   #     monitor: val_loss
              #   #     patience: 2
              #   - class_path: lightning.pytorch.callbacks.lr_monitor.LearningRateMonitor
              #     init_args:
              #       logging_interval: step
              #   # - class_path: lightning.pytorch.callbacks.ModelCheckpoint
              #   #   init_args:
              #   #     dirpath: checkpoints
              #   #     filename: best-checkpoint
              #   #     mode: min
              #   #     monitor: val_loss
              #   #     save_top_k: 1
              #   #     verbose: true
              check_val_every_n_epoch: 1
              default_root_dir: null
              detect_anomaly: false
              deterministic: null
              devices: auto #[0]
              enable_checkpointing: true
              enable_model_summary: null
              enable_progress_bar: null
              fast_dev_run: false
              gradient_clip_algorithm: null
              gradient_clip_val: null
              inference_mode: true
              limit_predict_batches: null
              limit_test_batches: null
              limit_train_batches: null
              limit_val_batches: null
              log_every_n_steps: 2
              logger: 
                # - class_path: lightning.pytorch.loggers.CSVLogger
                #   init_args:
                #     save_dir: ml_logs/csv_logs
                class_path: lightning.pytorch.loggers.MLFlowLogger
                init_args:
                  experiment_name: 3DGAN
                  save_dir: ml_logs/mlflow_logs
                  log_model: all
              max_epochs: 1
              max_steps: 20
              max_time: null
              min_epochs: null
              min_steps: null
              num_sanity_val_steps: null
              overfit_batches: 0.0
              plugins: null
              profiler: null
              reload_dataloaders_every_n_epochs: 0
              strategy: ddp_find_unused_parameters_true #auto
              sync_batchnorm: false
              use_distributed_sampler: true
              val_check_interval: null

            # Lightning Model configuration
            model:
              class_path: model.ThreeDGAN
              init_args:
                latent_size: 256
                batch_size: 64
                loss_weights: [3, 0.1, 25, 0.1]
                power: 0.85
                lr: 0.001
                checkpoint_path: exp_data/3dgan.pth

            # Lightning data module configuration
            data:
              class_path: dataloader.ParticlesDataModule
              init_args:
                datapath: exp_data/*/*.h5
                batch_size: 64

      - class_path: saver.ParticleImagesSaver
        init_args:
          save_dir: 3dgan-generated